---
title: "capstone"
author: "Drew Hall"
date: "July 8, 2018"
output: html_document
---

```{r}
library(readr)
library(dplyr)
library(tidyr)
library(ggplot2)
dataset_Facebook <- read_csv("~/Projects/dataset_Facebook.csv")
View(dataset_Facebook)
```

```{r dataset_Facebook}
capstone <- dataset_Facebook
```
Getting a feel for the data.
```{r}
head(capstone)
dim(capstone)

lapply(capstone, class)

summary (capstone)
```
Cleaning the data, and getting rid of the NAs
```{r}
capstone <- na.omit(capstone)
which(is.na(capstone),arr.ind = TRUE)
```
Preprocessing..
```{r}
library(caret)
library(lattice)
preProcValues <- preProcess(capstone, method = c("center", "scale"))
trainTransformed <- predict(preProcValues, capstone)
```

```{r}
idxTrain <- sample(seq(1,nrow(capstone), 0.70* nrow(capstone) ,replace = FALSE)) 
idxTest <- setdiff(seq(1,nrow(capstone),idxTrain)
trainX <- inputData[,-8][idxTrain, ]
testX <- inputData[idxTest,-`Lifetime Post Consumers`]
testY <- inputData[,8][idxTest]
trainY <- inputData[,8][idxTrain]

```



```{r}
x <- subset(capstone, select = -`Lifetime Post Consumers`)
y <-capstone$`Lifetime Post Consumers`
```

```{r}
library("e1071")
svm_model <- svm(`Lifetime Post Consumers` ~ ., data = capstone)
summary(svm_model)
```

```{r}
pred <- predict(svm_model, x)
system.time(pred <- predict(svm_model, x))

table(pred, y)
```

```{r}
svm_tune <- tune(svm, train.x = x, train.y = y,
                 kernel = "radial", ranges = list(cost =10^(-1:2), gamma = c(.5, 1, 2)))

print(svm_tune)
```

```{r}
svm_model_after_tune <- svm(`Lifetime Post Consumers` ~ ., data = capstone, kernel = "radial", cost = 1, gamma = 0.5)

summary(svm_model_after_tune)
```

```{r}
pred <- predict(svm_model_after_tune, x)
system.time(predict(svm_model_after_tune, x))
```

```{r}
table(pred, y)
```


I'll be fixing this up soon.
```{r}
ggplot(capstone, aes(x =`Lifetime Post Consumers`, y =`Post Weekday`, col = Paid )) + geom_histogram()

ggplot(capstone, aes(x =`Lifetime Post Consumers`, y =`Post Weekday`, col = Paid )) + geom_plot()

ggplot(capstone, aes(x =`Lifetime Post Consumers`, y =`Post Month`, col = Paid )) + geom_histogram()


```

